function overlap_cuboid_binary(	xAB::Float64,
							yAB::Float64,
							zAB::Float64,
							a11::Float64,
							a12::Float64,
							a13::Float64,
							a21::Float64,
							a22::Float64,
							a23::Float64,
							a31::Float64,
							a32::Float64,
							a33::Float64,
							b11::Float64,
							b12::Float64,
							b13::Float64,
							b21::Float64,
							b22::Float64,
							b23::Float64,
							b31::Float64,
							b32::Float64,
							b33::Float64,
							r1a::Float64,
							r2a::Float64,
							r3a::Float64,
							r1b::Float64,
							r2b::Float64,
							r3b::Float64)

	overlapfun::Float64 = 1.0

	cA::Array{Float64, 1} = zeros(8)
	cB::Array{Float64, 1} = zeros(8)
	
	cA = [ - a11*(a11*r1a + a12*r2a + a13*r3a) - a21*(a21*r1a + a22*r2a + a23*r3a) - a31*(a31*r1a + a32*r2a + a33*r3a), - a11*(a11*r1a + a12*r2a - a13*r3a) - a21*(a21*r1a + a22*r2a - a23*r3a) - a31*(a31*r1a + a32*r2a - a33*r3a), - a11*(a11*r1a - a12*r2a + a13*r3a) - a21*(a21*r1a - a22*r2a + a23*r3a) - a31*(a31*r1a - a32*r2a + a33*r3a), a11*(a12*r2a - a11*r1a + a13*r3a) + a21*(a22*r2a - a21*r1a + a23*r3a) + a31*(a32*r2a - a31*r1a + a33*r3a), - a11*(a12*r2a - a11*r1a + a13*r3a) - a21*(a22*r2a - a21*r1a + a23*r3a) - a31*(a32*r2a - a31*r1a + a33*r3a), a11*(a11*r1a - a12*r2a + a13*r3a) + a21*(a21*r1a - a22*r2a + a23*r3a) + a31*(a31*r1a - a32*r2a + a33*r3a), a11*(a11*r1a + a12*r2a - a13*r3a) + a21*(a21*r1a + a22*r2a - a23*r3a) + a31*(a31*r1a + a32*r2a - a33*r3a), a11*(a11*r1a + a12*r2a + a13*r3a) + a21*(a21*r1a + a22*r2a + a23*r3a) + a31*(a31*r1a + a32*r2a + a33*r3a)]
	cB = [ - a11*(b11*r1b - xAB + b12*r2b + b13*r3b) - a21*(b21*r1b - yAB + b22*r2b + b23*r3b) - a31*(b31*r1b - zAB + b32*r2b + b33*r3b), a11*(xAB - b11*r1b - b12*r2b + b13*r3b) + a21*(yAB - b21*r1b - b22*r2b + b23*r3b) + a31*(zAB - b31*r1b - b32*r2b + b33*r3b), a11*(xAB - b11*r1b + b12*r2b - b13*r3b) + a21*(yAB - b21*r1b + b22*r2b - b23*r3b) + a31*(zAB - b31*r1b + b32*r2b - b33*r3b), a11*(xAB - b11*r1b + b12*r2b + b13*r3b) + a21*(yAB - b21*r1b + b22*r2b + b23*r3b) + a31*(zAB - b31*r1b + b32*r2b + b33*r3b), a11*(xAB + b11*r1b - b12*r2b - b13*r3b) + a21*(yAB + b21*r1b - b22*r2b - b23*r3b) + a31*(zAB + b31*r1b - b32*r2b - b33*r3b), a11*(xAB + b11*r1b - b12*r2b + b13*r3b) + a21*(yAB + b21*r1b - b22*r2b + b23*r3b) + a31*(zAB + b31*r1b - b32*r2b + b33*r3b), a11*(xAB + b11*r1b + b12*r2b - b13*r3b) + a21*(yAB + b21*r1b + b22*r2b - b23*r3b) + a31*(zAB + b31*r1b + b32*r2b - b33*r3b), a11*(xAB + b11*r1b + b12*r2b + b13*r3b) + a21*(yAB + b21*r1b + b22*r2b + b23*r3b) + a31*(zAB + b31*r1b + b32*r2b + b33*r3b)]
	if minimum(cA) >= maximum(cB) || maximum(cA) <= minimum(cB)
		overlapfun = 0.0
		return overlapfun
	end
	 
	cA = [ - a12*(a11*r1a + a12*r2a + a13*r3a) - a22*(a21*r1a + a22*r2a + a23*r3a) - a32*(a31*r1a + a32*r2a + a33*r3a), - a12*(a11*r1a + a12*r2a - a13*r3a) - a22*(a21*r1a + a22*r2a - a23*r3a) - a32*(a31*r1a + a32*r2a - a33*r3a), - a12*(a11*r1a - a12*r2a + a13*r3a) - a22*(a21*r1a - a22*r2a + a23*r3a) - a32*(a31*r1a - a32*r2a + a33*r3a), a12*(a12*r2a - a11*r1a + a13*r3a) + a22*(a22*r2a - a21*r1a + a23*r3a) + a32*(a32*r2a - a31*r1a + a33*r3a), - a12*(a12*r2a - a11*r1a + a13*r3a) - a22*(a22*r2a - a21*r1a + a23*r3a) - a32*(a32*r2a - a31*r1a + a33*r3a), a12*(a11*r1a - a12*r2a + a13*r3a) + a22*(a21*r1a - a22*r2a + a23*r3a) + a32*(a31*r1a - a32*r2a + a33*r3a), a12*(a11*r1a + a12*r2a - a13*r3a) + a22*(a21*r1a + a22*r2a - a23*r3a) + a32*(a31*r1a + a32*r2a - a33*r3a), a12*(a11*r1a + a12*r2a + a13*r3a) + a22*(a21*r1a + a22*r2a + a23*r3a) + a32*(a31*r1a + a32*r2a + a33*r3a)]
	cB = [ - a12*(b11*r1b - xAB + b12*r2b + b13*r3b) - a22*(b21*r1b - yAB + b22*r2b + b23*r3b) - a32*(b31*r1b - zAB + b32*r2b + b33*r3b), a12*(xAB - b11*r1b - b12*r2b + b13*r3b) + a22*(yAB - b21*r1b - b22*r2b + b23*r3b) + a32*(zAB - b31*r1b - b32*r2b + b33*r3b), a12*(xAB - b11*r1b + b12*r2b - b13*r3b) + a22*(yAB - b21*r1b + b22*r2b - b23*r3b) + a32*(zAB - b31*r1b + b32*r2b - b33*r3b), a12*(xAB - b11*r1b + b12*r2b + b13*r3b) + a22*(yAB - b21*r1b + b22*r2b + b23*r3b) + a32*(zAB - b31*r1b + b32*r2b + b33*r3b), a12*(xAB + b11*r1b - b12*r2b - b13*r3b) + a22*(yAB + b21*r1b - b22*r2b - b23*r3b) + a32*(zAB + b31*r1b - b32*r2b - b33*r3b), a12*(xAB + b11*r1b - b12*r2b + b13*r3b) + a22*(yAB + b21*r1b - b22*r2b + b23*r3b) + a32*(zAB + b31*r1b - b32*r2b + b33*r3b), a12*(xAB + b11*r1b + b12*r2b - b13*r3b) + a22*(yAB + b21*r1b + b22*r2b - b23*r3b) + a32*(zAB + b31*r1b + b32*r2b - b33*r3b), a12*(xAB + b11*r1b + b12*r2b + b13*r3b) + a22*(yAB + b21*r1b + b22*r2b + b23*r3b) + a32*(zAB + b31*r1b + b32*r2b + b33*r3b)]
	if minimum(cA) >= maximum(cB) || maximum(cA) <= minimum(cB)
		overlapfun = 0.0
		return overlapfun
	end
	
	cA = [ - a13*(a11*r1a + a12*r2a + a13*r3a) - a23*(a21*r1a + a22*r2a + a23*r3a) - a33*(a31*r1a + a32*r2a + a33*r3a), - a13*(a11*r1a + a12*r2a - a13*r3a) - a23*(a21*r1a + a22*r2a - a23*r3a) - a33*(a31*r1a + a32*r2a - a33*r3a), - a13*(a11*r1a - a12*r2a + a13*r3a) - a23*(a21*r1a - a22*r2a + a23*r3a) - a33*(a31*r1a - a32*r2a + a33*r3a), a13*(a12*r2a - a11*r1a + a13*r3a) + a23*(a22*r2a - a21*r1a + a23*r3a) + a33*(a32*r2a - a31*r1a + a33*r3a), - a13*(a12*r2a - a11*r1a + a13*r3a) - a23*(a22*r2a - a21*r1a + a23*r3a) - a33*(a32*r2a - a31*r1a + a33*r3a), a13*(a11*r1a - a12*r2a + a13*r3a) + a23*(a21*r1a - a22*r2a + a23*r3a) + a33*(a31*r1a - a32*r2a + a33*r3a), a13*(a11*r1a + a12*r2a - a13*r3a) + a23*(a21*r1a + a22*r2a - a23*r3a) + a33*(a31*r1a + a32*r2a - a33*r3a), a13*(a11*r1a + a12*r2a + a13*r3a) + a23*(a21*r1a + a22*r2a + a23*r3a) + a33*(a31*r1a + a32*r2a + a33*r3a)]
	cB = [ - a13*(b11*r1b - xAB + b12*r2b + b13*r3b) - a23*(b21*r1b - yAB + b22*r2b + b23*r3b) - a33*(b31*r1b - zAB + b32*r2b + b33*r3b), a13*(xAB - b11*r1b - b12*r2b + b13*r3b) + a23*(yAB - b21*r1b - b22*r2b + b23*r3b) + a33*(zAB - b31*r1b - b32*r2b + b33*r3b), a13*(xAB - b11*r1b + b12*r2b - b13*r3b) + a23*(yAB - b21*r1b + b22*r2b - b23*r3b) + a33*(zAB - b31*r1b + b32*r2b - b33*r3b), a13*(xAB - b11*r1b + b12*r2b + b13*r3b) + a23*(yAB - b21*r1b + b22*r2b + b23*r3b) + a33*(zAB - b31*r1b + b32*r2b + b33*r3b), a13*(xAB + b11*r1b - b12*r2b - b13*r3b) + a23*(yAB + b21*r1b - b22*r2b - b23*r3b) + a33*(zAB + b31*r1b - b32*r2b - b33*r3b), a13*(xAB + b11*r1b - b12*r2b + b13*r3b) + a23*(yAB + b21*r1b - b22*r2b + b23*r3b) + a33*(zAB + b31*r1b - b32*r2b + b33*r3b), a13*(xAB + b11*r1b + b12*r2b - b13*r3b) + a23*(yAB + b21*r1b + b22*r2b - b23*r3b) + a33*(zAB + b31*r1b + b32*r2b - b33*r3b), a13*(xAB + b11*r1b + b12*r2b + b13*r3b) + a23*(yAB + b21*r1b + b22*r2b + b23*r3b) + a33*(zAB + b31*r1b + b32*r2b + b33*r3b)]
	if minimum(cA) >= maximum(cB) || maximum(cA) <= minimum(cB)
		overlapfun = 0.0
		return overlapfun
	end
 
	cA = [ - b11*(a11*r1a + a12*r2a + a13*r3a) - b21*(a21*r1a + a22*r2a + a23*r3a) - b31*(a31*r1a + a32*r2a + a33*r3a), - b11*(a11*r1a + a12*r2a - a13*r3a) - b21*(a21*r1a + a22*r2a - a23*r3a) - b31*(a31*r1a + a32*r2a - a33*r3a), - b11*(a11*r1a - a12*r2a + a13*r3a) - b21*(a21*r1a - a22*r2a + a23*r3a) - b31*(a31*r1a - a32*r2a + a33*r3a), b11*(a12*r2a - a11*r1a + a13*r3a) + b21*(a22*r2a - a21*r1a + a23*r3a) + b31*(a32*r2a - a31*r1a + a33*r3a), - b11*(a12*r2a - a11*r1a + a13*r3a) - b21*(a22*r2a - a21*r1a + a23*r3a) - b31*(a32*r2a - a31*r1a + a33*r3a), b11*(a11*r1a - a12*r2a + a13*r3a) + b21*(a21*r1a - a22*r2a + a23*r3a) + b31*(a31*r1a - a32*r2a + a33*r3a), b11*(a11*r1a + a12*r2a - a13*r3a) + b21*(a21*r1a + a22*r2a - a23*r3a) + b31*(a31*r1a + a32*r2a - a33*r3a), b11*(a11*r1a + a12*r2a + a13*r3a) + b21*(a21*r1a + a22*r2a + a23*r3a) + b31*(a31*r1a + a32*r2a + a33*r3a)]
	cB = [ - b11*(b11*r1b - xAB + b12*r2b + b13*r3b) - b21*(b21*r1b - yAB + b22*r2b + b23*r3b) - b31*(b31*r1b - zAB + b32*r2b + b33*r3b), b11*(xAB - b11*r1b - b12*r2b + b13*r3b) + b21*(yAB - b21*r1b - b22*r2b + b23*r3b) + b31*(zAB - b31*r1b - b32*r2b + b33*r3b), b11*(xAB - b11*r1b + b12*r2b - b13*r3b) + b21*(yAB - b21*r1b + b22*r2b - b23*r3b) + b31*(zAB - b31*r1b + b32*r2b - b33*r3b), b11*(xAB - b11*r1b + b12*r2b + b13*r3b) + b21*(yAB - b21*r1b + b22*r2b + b23*r3b) + b31*(zAB - b31*r1b + b32*r2b + b33*r3b), b11*(xAB + b11*r1b - b12*r2b - b13*r3b) + b21*(yAB + b21*r1b - b22*r2b - b23*r3b) + b31*(zAB + b31*r1b - b32*r2b - b33*r3b), b11*(xAB + b11*r1b - b12*r2b + b13*r3b) + b21*(yAB + b21*r1b - b22*r2b + b23*r3b) + b31*(zAB + b31*r1b - b32*r2b + b33*r3b), b11*(xAB + b11*r1b + b12*r2b - b13*r3b) + b21*(yAB + b21*r1b + b22*r2b - b23*r3b) + b31*(zAB + b31*r1b + b32*r2b - b33*r3b), b11*(xAB + b11*r1b + b12*r2b + b13*r3b) + b21*(yAB + b21*r1b + b22*r2b + b23*r3b) + b31*(zAB + b31*r1b + b32*r2b + b33*r3b)]
	if minimum(cA) >= maximum(cB) || maximum(cA) <= minimum(cB)
		overlapfun = 0.0
		return overlapfun
	end
	
	cA = [ - b12*(a11*r1a + a12*r2a + a13*r3a) - b22*(a21*r1a + a22*r2a + a23*r3a) - b32*(a31*r1a + a32*r2a + a33*r3a), - b12*(a11*r1a + a12*r2a - a13*r3a) - b22*(a21*r1a + a22*r2a - a23*r3a) - b32*(a31*r1a + a32*r2a - a33*r3a), - b12*(a11*r1a - a12*r2a + a13*r3a) - b22*(a21*r1a - a22*r2a + a23*r3a) - b32*(a31*r1a - a32*r2a + a33*r3a), b12*(a12*r2a - a11*r1a + a13*r3a) + b22*(a22*r2a - a21*r1a + a23*r3a) + b32*(a32*r2a - a31*r1a + a33*r3a), - b12*(a12*r2a - a11*r1a + a13*r3a) - b22*(a22*r2a - a21*r1a + a23*r3a) - b32*(a32*r2a - a31*r1a + a33*r3a), b12*(a11*r1a - a12*r2a + a13*r3a) + b22*(a21*r1a - a22*r2a + a23*r3a) + b32*(a31*r1a - a32*r2a + a33*r3a), b12*(a11*r1a + a12*r2a - a13*r3a) + b22*(a21*r1a + a22*r2a - a23*r3a) + b32*(a31*r1a + a32*r2a - a33*r3a), b12*(a11*r1a + a12*r2a + a13*r3a) + b22*(a21*r1a + a22*r2a + a23*r3a) + b32*(a31*r1a + a32*r2a + a33*r3a)]
	cB = [ - b12*(b11*r1b - xAB + b12*r2b + b13*r3b) - b22*(b21*r1b - yAB + b22*r2b + b23*r3b) - b32*(b31*r1b - zAB + b32*r2b + b33*r3b), b12*(xAB - b11*r1b - b12*r2b + b13*r3b) + b22*(yAB - b21*r1b - b22*r2b + b23*r3b) + b32*(zAB - b31*r1b - b32*r2b + b33*r3b), b12*(xAB - b11*r1b + b12*r2b - b13*r3b) + b22*(yAB - b21*r1b + b22*r2b - b23*r3b) + b32*(zAB - b31*r1b + b32*r2b - b33*r3b), b12*(xAB - b11*r1b + b12*r2b + b13*r3b) + b22*(yAB - b21*r1b + b22*r2b + b23*r3b) + b32*(zAB - b31*r1b + b32*r2b + b33*r3b), b12*(xAB + b11*r1b - b12*r2b - b13*r3b) + b22*(yAB + b21*r1b - b22*r2b - b23*r3b) + b32*(zAB + b31*r1b - b32*r2b - b33*r3b), b12*(xAB + b11*r1b - b12*r2b + b13*r3b) + b22*(yAB + b21*r1b - b22*r2b + b23*r3b) + b32*(zAB + b31*r1b - b32*r2b + b33*r3b), b12*(xAB + b11*r1b + b12*r2b - b13*r3b) + b22*(yAB + b21*r1b + b22*r2b - b23*r3b) + b32*(zAB + b31*r1b + b32*r2b - b33*r3b), b12*(xAB + b11*r1b + b12*r2b + b13*r3b) + b22*(yAB + b21*r1b + b22*r2b + b23*r3b) + b32*(zAB + b31*r1b + b32*r2b + b33*r3b)]
	if minimum(cA) >= maximum(cB) || maximum(cA) <= minimum(cB)
		overlapfun = 0.0
		return overlapfun
	end
	
	cA = [ - b13*(a11*r1a + a12*r2a + a13*r3a) - b23*(a21*r1a + a22*r2a + a23*r3a) - b33*(a31*r1a + a32*r2a + a33*r3a), - b13*(a11*r1a + a12*r2a - a13*r3a) - b23*(a21*r1a + a22*r2a - a23*r3a) - b33*(a31*r1a + a32*r2a - a33*r3a), - b13*(a11*r1a - a12*r2a + a13*r3a) - b23*(a21*r1a - a22*r2a + a23*r3a) - b33*(a31*r1a - a32*r2a + a33*r3a), b13*(a12*r2a - a11*r1a + a13*r3a) + b23*(a22*r2a - a21*r1a + a23*r3a) + b33*(a32*r2a - a31*r1a + a33*r3a), - b13*(a12*r2a - a11*r1a + a13*r3a) - b23*(a22*r2a - a21*r1a + a23*r3a) - b33*(a32*r2a - a31*r1a + a33*r3a), b13*(a11*r1a - a12*r2a + a13*r3a) + b23*(a21*r1a - a22*r2a + a23*r3a) + b33*(a31*r1a - a32*r2a + a33*r3a), b13*(a11*r1a + a12*r2a - a13*r3a) + b23*(a21*r1a + a22*r2a - a23*r3a) + b33*(a31*r1a + a32*r2a - a33*r3a), b13*(a11*r1a + a12*r2a + a13*r3a) + b23*(a21*r1a + a22*r2a + a23*r3a) + b33*(a31*r1a + a32*r2a + a33*r3a)]
	cB = [ - b13*(b11*r1b - xAB + b12*r2b + b13*r3b) - b23*(b21*r1b - yAB + b22*r2b + b23*r3b) - b33*(b31*r1b - zAB + b32*r2b + b33*r3b), b13*(xAB - b11*r1b - b12*r2b + b13*r3b) + b23*(yAB - b21*r1b - b22*r2b + b23*r3b) + b33*(zAB - b31*r1b - b32*r2b + b33*r3b), b13*(xAB - b11*r1b + b12*r2b - b13*r3b) + b23*(yAB - b21*r1b + b22*r2b - b23*r3b) + b33*(zAB - b31*r1b + b32*r2b - b33*r3b), b13*(xAB - b11*r1b + b12*r2b + b13*r3b) + b23*(yAB - b21*r1b + b22*r2b + b23*r3b) + b33*(zAB - b31*r1b + b32*r2b + b33*r3b), b13*(xAB + b11*r1b - b12*r2b - b13*r3b) + b23*(yAB + b21*r1b - b22*r2b - b23*r3b) + b33*(zAB + b31*r1b - b32*r2b - b33*r3b), b13*(xAB + b11*r1b - b12*r2b + b13*r3b) + b23*(yAB + b21*r1b - b22*r2b + b23*r3b) + b33*(zAB + b31*r1b - b32*r2b + b33*r3b), b13*(xAB + b11*r1b + b12*r2b - b13*r3b) + b23*(yAB + b21*r1b + b22*r2b - b23*r3b) + b33*(zAB + b31*r1b + b32*r2b - b33*r3b), b13*(xAB + b11*r1b + b12*r2b + b13*r3b) + b23*(yAB + b21*r1b + b22*r2b + b23*r3b) + b33*(zAB + b31*r1b + b32*r2b + b33*r3b)]
	if minimum(cA) >= maximum(cB) || maximum(cA) <= minimum(cB)
		overlapfun = 0.0
		return overlapfun
	end
	
	cA = [ ((a11*b31 - a31*b11)*(a21*r1a + a22*r2a + a23*r3a))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) - ((a21*b31 - a31*b21)*(a11*r1a + a12*r2a + a13*r3a))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) - ((a11*b21 - a21*b11)*(a31*r1a + a32*r2a + a33*r3a))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2), ((a11*b31 - a31*b11)*(a21*r1a + a22*r2a - a23*r3a))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) - ((a21*b31 - a31*b21)*(a11*r1a + a12*r2a - a13*r3a))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) - ((a11*b21 - a21*b11)*(a31*r1a + a32*r2a - a33*r3a))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2), ((a11*b31 - a31*b11)*(a21*r1a - a22*r2a + a23*r3a))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) - ((a21*b31 - a31*b21)*(a11*r1a - a12*r2a + a13*r3a))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) - ((a11*b21 - a21*b11)*(a31*r1a - a32*r2a + a33*r3a))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2), ((a21*b31 - a31*b21)*(a12*r2a - a11*r1a + a13*r3a))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) - ((a11*b31 - a31*b11)*(a22*r2a - a21*r1a + a23*r3a))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) + ((a11*b21 - a21*b11)*(a32*r2a - a31*r1a + a33*r3a))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2), ((a11*b31 - a31*b11)*(a22*r2a - a21*r1a + a23*r3a))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) - ((a21*b31 - a31*b21)*(a12*r2a - a11*r1a + a13*r3a))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) - ((a11*b21 - a21*b11)*(a32*r2a - a31*r1a + a33*r3a))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2), ((a21*b31 - a31*b21)*(a11*r1a - a12*r2a + a13*r3a))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) - ((a11*b31 - a31*b11)*(a21*r1a - a22*r2a + a23*r3a))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) + ((a11*b21 - a21*b11)*(a31*r1a - a32*r2a + a33*r3a))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2), ((a21*b31 - a31*b21)*(a11*r1a + a12*r2a - a13*r3a))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) - ((a11*b31 - a31*b11)*(a21*r1a + a22*r2a - a23*r3a))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) + ((a11*b21 - a21*b11)*(a31*r1a + a32*r2a - a33*r3a))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2), ((a21*b31 - a31*b21)*(a11*r1a + a12*r2a + a13*r3a))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) - ((a11*b31 - a31*b11)*(a21*r1a + a22*r2a + a23*r3a))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) + ((a11*b21 - a21*b11)*(a31*r1a + a32*r2a + a33*r3a))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2)]
	cB = [ ((a11*b31 - a31*b11)*(b21*r1b - yAB + b22*r2b + b23*r3b))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) - ((a21*b31 - a31*b21)*(b11*r1b - xAB + b12*r2b + b13*r3b))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) - ((a11*b21 - a21*b11)*(b31*r1b - zAB + b32*r2b + b33*r3b))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2), ((a21*b31 - a31*b21)*(xAB - b11*r1b - b12*r2b + b13*r3b))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) - ((a11*b31 - a31*b11)*(yAB - b21*r1b - b22*r2b + b23*r3b))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) + ((a11*b21 - a21*b11)*(zAB - b31*r1b - b32*r2b + b33*r3b))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2), ((a21*b31 - a31*b21)*(xAB - b11*r1b + b12*r2b - b13*r3b))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) - ((a11*b31 - a31*b11)*(yAB - b21*r1b + b22*r2b - b23*r3b))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) + ((a11*b21 - a21*b11)*(zAB - b31*r1b + b32*r2b - b33*r3b))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2), ((a21*b31 - a31*b21)*(xAB - b11*r1b + b12*r2b + b13*r3b))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) - ((a11*b31 - a31*b11)*(yAB - b21*r1b + b22*r2b + b23*r3b))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) + ((a11*b21 - a21*b11)*(zAB - b31*r1b + b32*r2b + b33*r3b))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2), ((a21*b31 - a31*b21)*(xAB + b11*r1b - b12*r2b - b13*r3b))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) - ((a11*b31 - a31*b11)*(yAB + b21*r1b - b22*r2b - b23*r3b))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) + ((a11*b21 - a21*b11)*(zAB + b31*r1b - b32*r2b - b33*r3b))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2), ((a21*b31 - a31*b21)*(xAB + b11*r1b - b12*r2b + b13*r3b))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) - ((a11*b31 - a31*b11)*(yAB + b21*r1b - b22*r2b + b23*r3b))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) + ((a11*b21 - a21*b11)*(zAB + b31*r1b - b32*r2b + b33*r3b))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2), ((a21*b31 - a31*b21)*(xAB + b11*r1b + b12*r2b - b13*r3b))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) - ((a11*b31 - a31*b11)*(yAB + b21*r1b + b22*r2b - b23*r3b))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) + ((a11*b21 - a21*b11)*(zAB + b31*r1b + b32*r2b - b33*r3b))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2), ((a21*b31 - a31*b21)*(xAB + b11*r1b + b12*r2b + b13*r3b))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) - ((a11*b31 - a31*b11)*(yAB + b21*r1b + b22*r2b + b23*r3b))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2) + ((a11*b21 - a21*b11)*(zAB + b31*r1b + b32*r2b + b33*r3b))/((a11*b21 - a21*b11)^2 + (a11*b31 - a31*b11)^2 + (a21*b31 - a31*b21)^2)^(1/2)]
	if minimum(cA) >= maximum(cB) || maximum(cA) <= minimum(cB)
		overlapfun = 0.0
		return overlapfun
	end
	
	cA = [ ((a11*b32 - a31*b12)*(a21*r1a + a22*r2a + a23*r3a))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) - ((a21*b32 - a31*b22)*(a11*r1a + a12*r2a + a13*r3a))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) - ((a11*b22 - a21*b12)*(a31*r1a + a32*r2a + a33*r3a))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2), ((a11*b32 - a31*b12)*(a21*r1a + a22*r2a - a23*r3a))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) - ((a21*b32 - a31*b22)*(a11*r1a + a12*r2a - a13*r3a))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) - ((a11*b22 - a21*b12)*(a31*r1a + a32*r2a - a33*r3a))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2), ((a11*b32 - a31*b12)*(a21*r1a - a22*r2a + a23*r3a))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) - ((a21*b32 - a31*b22)*(a11*r1a - a12*r2a + a13*r3a))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) - ((a11*b22 - a21*b12)*(a31*r1a - a32*r2a + a33*r3a))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2), ((a21*b32 - a31*b22)*(a12*r2a - a11*r1a + a13*r3a))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) - ((a11*b32 - a31*b12)*(a22*r2a - a21*r1a + a23*r3a))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) + ((a11*b22 - a21*b12)*(a32*r2a - a31*r1a + a33*r3a))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2), ((a11*b32 - a31*b12)*(a22*r2a - a21*r1a + a23*r3a))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) - ((a21*b32 - a31*b22)*(a12*r2a - a11*r1a + a13*r3a))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) - ((a11*b22 - a21*b12)*(a32*r2a - a31*r1a + a33*r3a))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2), ((a21*b32 - a31*b22)*(a11*r1a - a12*r2a + a13*r3a))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) - ((a11*b32 - a31*b12)*(a21*r1a - a22*r2a + a23*r3a))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) + ((a11*b22 - a21*b12)*(a31*r1a - a32*r2a + a33*r3a))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2), ((a21*b32 - a31*b22)*(a11*r1a + a12*r2a - a13*r3a))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) - ((a11*b32 - a31*b12)*(a21*r1a + a22*r2a - a23*r3a))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) + ((a11*b22 - a21*b12)*(a31*r1a + a32*r2a - a33*r3a))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2), ((a21*b32 - a31*b22)*(a11*r1a + a12*r2a + a13*r3a))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) - ((a11*b32 - a31*b12)*(a21*r1a + a22*r2a + a23*r3a))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) + ((a11*b22 - a21*b12)*(a31*r1a + a32*r2a + a33*r3a))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2)]
	cB = [ ((a11*b32 - a31*b12)*(b21*r1b - yAB + b22*r2b + b23*r3b))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) - ((a21*b32 - a31*b22)*(b11*r1b - xAB + b12*r2b + b13*r3b))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) - ((a11*b22 - a21*b12)*(b31*r1b - zAB + b32*r2b + b33*r3b))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2), ((a21*b32 - a31*b22)*(xAB - b11*r1b - b12*r2b + b13*r3b))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) - ((a11*b32 - a31*b12)*(yAB - b21*r1b - b22*r2b + b23*r3b))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) + ((a11*b22 - a21*b12)*(zAB - b31*r1b - b32*r2b + b33*r3b))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2), ((a21*b32 - a31*b22)*(xAB - b11*r1b + b12*r2b - b13*r3b))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) - ((a11*b32 - a31*b12)*(yAB - b21*r1b + b22*r2b - b23*r3b))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) + ((a11*b22 - a21*b12)*(zAB - b31*r1b + b32*r2b - b33*r3b))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2), ((a21*b32 - a31*b22)*(xAB - b11*r1b + b12*r2b + b13*r3b))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) - ((a11*b32 - a31*b12)*(yAB - b21*r1b + b22*r2b + b23*r3b))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) + ((a11*b22 - a21*b12)*(zAB - b31*r1b + b32*r2b + b33*r3b))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2), ((a21*b32 - a31*b22)*(xAB + b11*r1b - b12*r2b - b13*r3b))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) - ((a11*b32 - a31*b12)*(yAB + b21*r1b - b22*r2b - b23*r3b))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) + ((a11*b22 - a21*b12)*(zAB + b31*r1b - b32*r2b - b33*r3b))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2), ((a21*b32 - a31*b22)*(xAB + b11*r1b - b12*r2b + b13*r3b))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) - ((a11*b32 - a31*b12)*(yAB + b21*r1b - b22*r2b + b23*r3b))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) + ((a11*b22 - a21*b12)*(zAB + b31*r1b - b32*r2b + b33*r3b))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2), ((a21*b32 - a31*b22)*(xAB + b11*r1b + b12*r2b - b13*r3b))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) - ((a11*b32 - a31*b12)*(yAB + b21*r1b + b22*r2b - b23*r3b))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) + ((a11*b22 - a21*b12)*(zAB + b31*r1b + b32*r2b - b33*r3b))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2), ((a21*b32 - a31*b22)*(xAB + b11*r1b + b12*r2b + b13*r3b))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) - ((a11*b32 - a31*b12)*(yAB + b21*r1b + b22*r2b + b23*r3b))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2) + ((a11*b22 - a21*b12)*(zAB + b31*r1b + b32*r2b + b33*r3b))/((a11*b22 - a21*b12)^2 + (a11*b32 - a31*b12)^2 + (a21*b32 - a31*b22)^2)^(1/2)]
	if minimum(cA) >= maximum(cB) || maximum(cA) <= minimum(cB)
		overlapfun = 0.0
		return overlapfun
	end
 
	cA = [ ((a11*b33 - a31*b13)*(a21*r1a + a22*r2a + a23*r3a))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) - ((a21*b33 - a31*b23)*(a11*r1a + a12*r2a + a13*r3a))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) - ((a11*b23 - a21*b13)*(a31*r1a + a32*r2a + a33*r3a))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2), ((a11*b33 - a31*b13)*(a21*r1a + a22*r2a - a23*r3a))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) - ((a21*b33 - a31*b23)*(a11*r1a + a12*r2a - a13*r3a))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) - ((a11*b23 - a21*b13)*(a31*r1a + a32*r2a - a33*r3a))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2), ((a11*b33 - a31*b13)*(a21*r1a - a22*r2a + a23*r3a))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) - ((a21*b33 - a31*b23)*(a11*r1a - a12*r2a + a13*r3a))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) - ((a11*b23 - a21*b13)*(a31*r1a - a32*r2a + a33*r3a))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2), ((a21*b33 - a31*b23)*(a12*r2a - a11*r1a + a13*r3a))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) - ((a11*b33 - a31*b13)*(a22*r2a - a21*r1a + a23*r3a))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) + ((a11*b23 - a21*b13)*(a32*r2a - a31*r1a + a33*r3a))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2), ((a11*b33 - a31*b13)*(a22*r2a - a21*r1a + a23*r3a))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) - ((a21*b33 - a31*b23)*(a12*r2a - a11*r1a + a13*r3a))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) - ((a11*b23 - a21*b13)*(a32*r2a - a31*r1a + a33*r3a))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2), ((a21*b33 - a31*b23)*(a11*r1a - a12*r2a + a13*r3a))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) - ((a11*b33 - a31*b13)*(a21*r1a - a22*r2a + a23*r3a))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) + ((a11*b23 - a21*b13)*(a31*r1a - a32*r2a + a33*r3a))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2), ((a21*b33 - a31*b23)*(a11*r1a + a12*r2a - a13*r3a))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) - ((a11*b33 - a31*b13)*(a21*r1a + a22*r2a - a23*r3a))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) + ((a11*b23 - a21*b13)*(a31*r1a + a32*r2a - a33*r3a))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2), ((a21*b33 - a31*b23)*(a11*r1a + a12*r2a + a13*r3a))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) - ((a11*b33 - a31*b13)*(a21*r1a + a22*r2a + a23*r3a))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) + ((a11*b23 - a21*b13)*(a31*r1a + a32*r2a + a33*r3a))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2)]
	cB = [ ((a11*b33 - a31*b13)*(b21*r1b - yAB + b22*r2b + b23*r3b))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) - ((a21*b33 - a31*b23)*(b11*r1b - xAB + b12*r2b + b13*r3b))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) - ((a11*b23 - a21*b13)*(b31*r1b - zAB + b32*r2b + b33*r3b))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2), ((a21*b33 - a31*b23)*(xAB - b11*r1b - b12*r2b + b13*r3b))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) - ((a11*b33 - a31*b13)*(yAB - b21*r1b - b22*r2b + b23*r3b))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) + ((a11*b23 - a21*b13)*(zAB - b31*r1b - b32*r2b + b33*r3b))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2), ((a21*b33 - a31*b23)*(xAB - b11*r1b + b12*r2b - b13*r3b))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) - ((a11*b33 - a31*b13)*(yAB - b21*r1b + b22*r2b - b23*r3b))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) + ((a11*b23 - a21*b13)*(zAB - b31*r1b + b32*r2b - b33*r3b))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2), ((a21*b33 - a31*b23)*(xAB - b11*r1b + b12*r2b + b13*r3b))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) - ((a11*b33 - a31*b13)*(yAB - b21*r1b + b22*r2b + b23*r3b))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) + ((a11*b23 - a21*b13)*(zAB - b31*r1b + b32*r2b + b33*r3b))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2), ((a21*b33 - a31*b23)*(xAB + b11*r1b - b12*r2b - b13*r3b))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) - ((a11*b33 - a31*b13)*(yAB + b21*r1b - b22*r2b - b23*r3b))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) + ((a11*b23 - a21*b13)*(zAB + b31*r1b - b32*r2b - b33*r3b))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2), ((a21*b33 - a31*b23)*(xAB + b11*r1b - b12*r2b + b13*r3b))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) - ((a11*b33 - a31*b13)*(yAB + b21*r1b - b22*r2b + b23*r3b))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) + ((a11*b23 - a21*b13)*(zAB + b31*r1b - b32*r2b + b33*r3b))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2), ((a21*b33 - a31*b23)*(xAB + b11*r1b + b12*r2b - b13*r3b))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) - ((a11*b33 - a31*b13)*(yAB + b21*r1b + b22*r2b - b23*r3b))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) + ((a11*b23 - a21*b13)*(zAB + b31*r1b + b32*r2b - b33*r3b))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2), ((a21*b33 - a31*b23)*(xAB + b11*r1b + b12*r2b + b13*r3b))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) - ((a11*b33 - a31*b13)*(yAB + b21*r1b + b22*r2b + b23*r3b))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2) + ((a11*b23 - a21*b13)*(zAB + b31*r1b + b32*r2b + b33*r3b))/((a11*b23 - a21*b13)^2 + (a11*b33 - a31*b13)^2 + (a21*b33 - a31*b23)^2)^(1/2)]
	if minimum(cA) >= maximum(cB) || maximum(cA) <= minimum(cB)
		overlapfun = 0.0
		return overlapfun
	end
	
	cA = [ ((a12*b31 - a32*b11)*(a21*r1a + a22*r2a + a23*r3a))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) - ((a22*b31 - a32*b21)*(a11*r1a + a12*r2a + a13*r3a))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) - ((a12*b21 - a22*b11)*(a31*r1a + a32*r2a + a33*r3a))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2), ((a12*b31 - a32*b11)*(a21*r1a + a22*r2a - a23*r3a))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) - ((a22*b31 - a32*b21)*(a11*r1a + a12*r2a - a13*r3a))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) - ((a12*b21 - a22*b11)*(a31*r1a + a32*r2a - a33*r3a))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2), ((a12*b31 - a32*b11)*(a21*r1a - a22*r2a + a23*r3a))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) - ((a22*b31 - a32*b21)*(a11*r1a - a12*r2a + a13*r3a))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) - ((a12*b21 - a22*b11)*(a31*r1a - a32*r2a + a33*r3a))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2), ((a22*b31 - a32*b21)*(a12*r2a - a11*r1a + a13*r3a))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) - ((a12*b31 - a32*b11)*(a22*r2a - a21*r1a + a23*r3a))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) + ((a12*b21 - a22*b11)*(a32*r2a - a31*r1a + a33*r3a))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2), ((a12*b31 - a32*b11)*(a22*r2a - a21*r1a + a23*r3a))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) - ((a22*b31 - a32*b21)*(a12*r2a - a11*r1a + a13*r3a))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) - ((a12*b21 - a22*b11)*(a32*r2a - a31*r1a + a33*r3a))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2), ((a22*b31 - a32*b21)*(a11*r1a - a12*r2a + a13*r3a))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) - ((a12*b31 - a32*b11)*(a21*r1a - a22*r2a + a23*r3a))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) + ((a12*b21 - a22*b11)*(a31*r1a - a32*r2a + a33*r3a))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2), ((a22*b31 - a32*b21)*(a11*r1a + a12*r2a - a13*r3a))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) - ((a12*b31 - a32*b11)*(a21*r1a + a22*r2a - a23*r3a))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) + ((a12*b21 - a22*b11)*(a31*r1a + a32*r2a - a33*r3a))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2), ((a22*b31 - a32*b21)*(a11*r1a + a12*r2a + a13*r3a))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) - ((a12*b31 - a32*b11)*(a21*r1a + a22*r2a + a23*r3a))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) + ((a12*b21 - a22*b11)*(a31*r1a + a32*r2a + a33*r3a))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2)]
	cB = [ ((a12*b31 - a32*b11)*(b21*r1b - yAB + b22*r2b + b23*r3b))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) - ((a22*b31 - a32*b21)*(b11*r1b - xAB + b12*r2b + b13*r3b))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) - ((a12*b21 - a22*b11)*(b31*r1b - zAB + b32*r2b + b33*r3b))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2), ((a22*b31 - a32*b21)*(xAB - b11*r1b - b12*r2b + b13*r3b))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) - ((a12*b31 - a32*b11)*(yAB - b21*r1b - b22*r2b + b23*r3b))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) + ((a12*b21 - a22*b11)*(zAB - b31*r1b - b32*r2b + b33*r3b))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2), ((a22*b31 - a32*b21)*(xAB - b11*r1b + b12*r2b - b13*r3b))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) - ((a12*b31 - a32*b11)*(yAB - b21*r1b + b22*r2b - b23*r3b))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) + ((a12*b21 - a22*b11)*(zAB - b31*r1b + b32*r2b - b33*r3b))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2), ((a22*b31 - a32*b21)*(xAB - b11*r1b + b12*r2b + b13*r3b))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) - ((a12*b31 - a32*b11)*(yAB - b21*r1b + b22*r2b + b23*r3b))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) + ((a12*b21 - a22*b11)*(zAB - b31*r1b + b32*r2b + b33*r3b))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2), ((a22*b31 - a32*b21)*(xAB + b11*r1b - b12*r2b - b13*r3b))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) - ((a12*b31 - a32*b11)*(yAB + b21*r1b - b22*r2b - b23*r3b))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) + ((a12*b21 - a22*b11)*(zAB + b31*r1b - b32*r2b - b33*r3b))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2), ((a22*b31 - a32*b21)*(xAB + b11*r1b - b12*r2b + b13*r3b))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) - ((a12*b31 - a32*b11)*(yAB + b21*r1b - b22*r2b + b23*r3b))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) + ((a12*b21 - a22*b11)*(zAB + b31*r1b - b32*r2b + b33*r3b))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2), ((a22*b31 - a32*b21)*(xAB + b11*r1b + b12*r2b - b13*r3b))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) - ((a12*b31 - a32*b11)*(yAB + b21*r1b + b22*r2b - b23*r3b))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) + ((a12*b21 - a22*b11)*(zAB + b31*r1b + b32*r2b - b33*r3b))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2), ((a22*b31 - a32*b21)*(xAB + b11*r1b + b12*r2b + b13*r3b))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) - ((a12*b31 - a32*b11)*(yAB + b21*r1b + b22*r2b + b23*r3b))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2) + ((a12*b21 - a22*b11)*(zAB + b31*r1b + b32*r2b + b33*r3b))/((a12*b21 - a22*b11)^2 + (a12*b31 - a32*b11)^2 + (a22*b31 - a32*b21)^2)^(1/2)]
	if minimum(cA) >= maximum(cB) || maximum(cA) <= minimum(cB)
		overlapfun = 0.0
		return overlapfun
	end
 
	cA = [ ((a12*b32 - a32*b12)*(a21*r1a + a22*r2a + a23*r3a))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) - ((a22*b32 - a32*b22)*(a11*r1a + a12*r2a + a13*r3a))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) - ((a12*b22 - a22*b12)*(a31*r1a + a32*r2a + a33*r3a))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2), ((a12*b32 - a32*b12)*(a21*r1a + a22*r2a - a23*r3a))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) - ((a22*b32 - a32*b22)*(a11*r1a + a12*r2a - a13*r3a))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) - ((a12*b22 - a22*b12)*(a31*r1a + a32*r2a - a33*r3a))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2), ((a12*b32 - a32*b12)*(a21*r1a - a22*r2a + a23*r3a))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) - ((a22*b32 - a32*b22)*(a11*r1a - a12*r2a + a13*r3a))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) - ((a12*b22 - a22*b12)*(a31*r1a - a32*r2a + a33*r3a))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2), ((a22*b32 - a32*b22)*(a12*r2a - a11*r1a + a13*r3a))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) - ((a12*b32 - a32*b12)*(a22*r2a - a21*r1a + a23*r3a))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) + ((a12*b22 - a22*b12)*(a32*r2a - a31*r1a + a33*r3a))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2), ((a12*b32 - a32*b12)*(a22*r2a - a21*r1a + a23*r3a))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) - ((a22*b32 - a32*b22)*(a12*r2a - a11*r1a + a13*r3a))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) - ((a12*b22 - a22*b12)*(a32*r2a - a31*r1a + a33*r3a))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2), ((a22*b32 - a32*b22)*(a11*r1a - a12*r2a + a13*r3a))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) - ((a12*b32 - a32*b12)*(a21*r1a - a22*r2a + a23*r3a))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) + ((a12*b22 - a22*b12)*(a31*r1a - a32*r2a + a33*r3a))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2), ((a22*b32 - a32*b22)*(a11*r1a + a12*r2a - a13*r3a))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) - ((a12*b32 - a32*b12)*(a21*r1a + a22*r2a - a23*r3a))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) + ((a12*b22 - a22*b12)*(a31*r1a + a32*r2a - a33*r3a))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2), ((a22*b32 - a32*b22)*(a11*r1a + a12*r2a + a13*r3a))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) - ((a12*b32 - a32*b12)*(a21*r1a + a22*r2a + a23*r3a))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) + ((a12*b22 - a22*b12)*(a31*r1a + a32*r2a + a33*r3a))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2)]
	cB = [ ((a12*b32 - a32*b12)*(b21*r1b - yAB + b22*r2b + b23*r3b))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) - ((a22*b32 - a32*b22)*(b11*r1b - xAB + b12*r2b + b13*r3b))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) - ((a12*b22 - a22*b12)*(b31*r1b - zAB + b32*r2b + b33*r3b))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2), ((a22*b32 - a32*b22)*(xAB - b11*r1b - b12*r2b + b13*r3b))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) - ((a12*b32 - a32*b12)*(yAB - b21*r1b - b22*r2b + b23*r3b))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) + ((a12*b22 - a22*b12)*(zAB - b31*r1b - b32*r2b + b33*r3b))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2), ((a22*b32 - a32*b22)*(xAB - b11*r1b + b12*r2b - b13*r3b))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) - ((a12*b32 - a32*b12)*(yAB - b21*r1b + b22*r2b - b23*r3b))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) + ((a12*b22 - a22*b12)*(zAB - b31*r1b + b32*r2b - b33*r3b))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2), ((a22*b32 - a32*b22)*(xAB - b11*r1b + b12*r2b + b13*r3b))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) - ((a12*b32 - a32*b12)*(yAB - b21*r1b + b22*r2b + b23*r3b))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) + ((a12*b22 - a22*b12)*(zAB - b31*r1b + b32*r2b + b33*r3b))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2), ((a22*b32 - a32*b22)*(xAB + b11*r1b - b12*r2b - b13*r3b))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) - ((a12*b32 - a32*b12)*(yAB + b21*r1b - b22*r2b - b23*r3b))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) + ((a12*b22 - a22*b12)*(zAB + b31*r1b - b32*r2b - b33*r3b))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2), ((a22*b32 - a32*b22)*(xAB + b11*r1b - b12*r2b + b13*r3b))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) - ((a12*b32 - a32*b12)*(yAB + b21*r1b - b22*r2b + b23*r3b))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) + ((a12*b22 - a22*b12)*(zAB + b31*r1b - b32*r2b + b33*r3b))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2), ((a22*b32 - a32*b22)*(xAB + b11*r1b + b12*r2b - b13*r3b))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) - ((a12*b32 - a32*b12)*(yAB + b21*r1b + b22*r2b - b23*r3b))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) + ((a12*b22 - a22*b12)*(zAB + b31*r1b + b32*r2b - b33*r3b))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2), ((a22*b32 - a32*b22)*(xAB + b11*r1b + b12*r2b + b13*r3b))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) - ((a12*b32 - a32*b12)*(yAB + b21*r1b + b22*r2b + b23*r3b))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2) + ((a12*b22 - a22*b12)*(zAB + b31*r1b + b32*r2b + b33*r3b))/((a12*b22 - a22*b12)^2 + (a12*b32 - a32*b12)^2 + (a22*b32 - a32*b22)^2)^(1/2)]
	if minimum(cA) >= maximum(cB) || maximum(cA) <= minimum(cB)
		overlapfun = 0.0
		return overlapfun
	end
	
	cA = [ ((a12*b33 - a32*b13)*(a21*r1a + a22*r2a + a23*r3a))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) - ((a22*b33 - a32*b23)*(a11*r1a + a12*r2a + a13*r3a))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) - ((a12*b23 - a22*b13)*(a31*r1a + a32*r2a + a33*r3a))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2), ((a12*b33 - a32*b13)*(a21*r1a + a22*r2a - a23*r3a))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) - ((a22*b33 - a32*b23)*(a11*r1a + a12*r2a - a13*r3a))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) - ((a12*b23 - a22*b13)*(a31*r1a + a32*r2a - a33*r3a))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2), ((a12*b33 - a32*b13)*(a21*r1a - a22*r2a + a23*r3a))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) - ((a22*b33 - a32*b23)*(a11*r1a - a12*r2a + a13*r3a))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) - ((a12*b23 - a22*b13)*(a31*r1a - a32*r2a + a33*r3a))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2), ((a22*b33 - a32*b23)*(a12*r2a - a11*r1a + a13*r3a))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) - ((a12*b33 - a32*b13)*(a22*r2a - a21*r1a + a23*r3a))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) + ((a12*b23 - a22*b13)*(a32*r2a - a31*r1a + a33*r3a))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2), ((a12*b33 - a32*b13)*(a22*r2a - a21*r1a + a23*r3a))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) - ((a22*b33 - a32*b23)*(a12*r2a - a11*r1a + a13*r3a))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) - ((a12*b23 - a22*b13)*(a32*r2a - a31*r1a + a33*r3a))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2), ((a22*b33 - a32*b23)*(a11*r1a - a12*r2a + a13*r3a))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) - ((a12*b33 - a32*b13)*(a21*r1a - a22*r2a + a23*r3a))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) + ((a12*b23 - a22*b13)*(a31*r1a - a32*r2a + a33*r3a))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2), ((a22*b33 - a32*b23)*(a11*r1a + a12*r2a - a13*r3a))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) - ((a12*b33 - a32*b13)*(a21*r1a + a22*r2a - a23*r3a))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) + ((a12*b23 - a22*b13)*(a31*r1a + a32*r2a - a33*r3a))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2), ((a22*b33 - a32*b23)*(a11*r1a + a12*r2a + a13*r3a))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) - ((a12*b33 - a32*b13)*(a21*r1a + a22*r2a + a23*r3a))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) + ((a12*b23 - a22*b13)*(a31*r1a + a32*r2a + a33*r3a))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2)]
	cB = [ ((a12*b33 - a32*b13)*(b21*r1b - yAB + b22*r2b + b23*r3b))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) - ((a22*b33 - a32*b23)*(b11*r1b - xAB + b12*r2b + b13*r3b))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) - ((a12*b23 - a22*b13)*(b31*r1b - zAB + b32*r2b + b33*r3b))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2), ((a22*b33 - a32*b23)*(xAB - b11*r1b - b12*r2b + b13*r3b))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) - ((a12*b33 - a32*b13)*(yAB - b21*r1b - b22*r2b + b23*r3b))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) + ((a12*b23 - a22*b13)*(zAB - b31*r1b - b32*r2b + b33*r3b))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2), ((a22*b33 - a32*b23)*(xAB - b11*r1b + b12*r2b - b13*r3b))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) - ((a12*b33 - a32*b13)*(yAB - b21*r1b + b22*r2b - b23*r3b))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) + ((a12*b23 - a22*b13)*(zAB - b31*r1b + b32*r2b - b33*r3b))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2), ((a22*b33 - a32*b23)*(xAB - b11*r1b + b12*r2b + b13*r3b))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) - ((a12*b33 - a32*b13)*(yAB - b21*r1b + b22*r2b + b23*r3b))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) + ((a12*b23 - a22*b13)*(zAB - b31*r1b + b32*r2b + b33*r3b))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2), ((a22*b33 - a32*b23)*(xAB + b11*r1b - b12*r2b - b13*r3b))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) - ((a12*b33 - a32*b13)*(yAB + b21*r1b - b22*r2b - b23*r3b))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) + ((a12*b23 - a22*b13)*(zAB + b31*r1b - b32*r2b - b33*r3b))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2), ((a22*b33 - a32*b23)*(xAB + b11*r1b - b12*r2b + b13*r3b))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) - ((a12*b33 - a32*b13)*(yAB + b21*r1b - b22*r2b + b23*r3b))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) + ((a12*b23 - a22*b13)*(zAB + b31*r1b - b32*r2b + b33*r3b))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2), ((a22*b33 - a32*b23)*(xAB + b11*r1b + b12*r2b - b13*r3b))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) - ((a12*b33 - a32*b13)*(yAB + b21*r1b + b22*r2b - b23*r3b))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) + ((a12*b23 - a22*b13)*(zAB + b31*r1b + b32*r2b - b33*r3b))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2), ((a22*b33 - a32*b23)*(xAB + b11*r1b + b12*r2b + b13*r3b))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) - ((a12*b33 - a32*b13)*(yAB + b21*r1b + b22*r2b + b23*r3b))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2) + ((a12*b23 - a22*b13)*(zAB + b31*r1b + b32*r2b + b33*r3b))/((a12*b23 - a22*b13)^2 + (a12*b33 - a32*b13)^2 + (a22*b33 - a32*b23)^2)^(1/2)]
	if minimum(cA) >= maximum(cB) || maximum(cA) <= minimum(cB)
		overlapfun = 0.0
		return overlapfun
	end
	
	cA = [ ((a13*b31 - a33*b11)*(a21*r1a + a22*r2a + a23*r3a))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) - ((a23*b31 - a33*b21)*(a11*r1a + a12*r2a + a13*r3a))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) - ((a13*b21 - a23*b11)*(a31*r1a + a32*r2a + a33*r3a))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2), ((a13*b31 - a33*b11)*(a21*r1a + a22*r2a - a23*r3a))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) - ((a23*b31 - a33*b21)*(a11*r1a + a12*r2a - a13*r3a))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) - ((a13*b21 - a23*b11)*(a31*r1a + a32*r2a - a33*r3a))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2), ((a13*b31 - a33*b11)*(a21*r1a - a22*r2a + a23*r3a))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) - ((a23*b31 - a33*b21)*(a11*r1a - a12*r2a + a13*r3a))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) - ((a13*b21 - a23*b11)*(a31*r1a - a32*r2a + a33*r3a))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2), ((a23*b31 - a33*b21)*(a12*r2a - a11*r1a + a13*r3a))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) - ((a13*b31 - a33*b11)*(a22*r2a - a21*r1a + a23*r3a))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) + ((a13*b21 - a23*b11)*(a32*r2a - a31*r1a + a33*r3a))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2), ((a13*b31 - a33*b11)*(a22*r2a - a21*r1a + a23*r3a))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) - ((a23*b31 - a33*b21)*(a12*r2a - a11*r1a + a13*r3a))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) - ((a13*b21 - a23*b11)*(a32*r2a - a31*r1a + a33*r3a))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2), ((a23*b31 - a33*b21)*(a11*r1a - a12*r2a + a13*r3a))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) - ((a13*b31 - a33*b11)*(a21*r1a - a22*r2a + a23*r3a))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) + ((a13*b21 - a23*b11)*(a31*r1a - a32*r2a + a33*r3a))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2), ((a23*b31 - a33*b21)*(a11*r1a + a12*r2a - a13*r3a))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) - ((a13*b31 - a33*b11)*(a21*r1a + a22*r2a - a23*r3a))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) + ((a13*b21 - a23*b11)*(a31*r1a + a32*r2a - a33*r3a))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2), ((a23*b31 - a33*b21)*(a11*r1a + a12*r2a + a13*r3a))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) - ((a13*b31 - a33*b11)*(a21*r1a + a22*r2a + a23*r3a))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) + ((a13*b21 - a23*b11)*(a31*r1a + a32*r2a + a33*r3a))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2)]
	cB = [ ((a13*b31 - a33*b11)*(b21*r1b - yAB + b22*r2b + b23*r3b))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) - ((a23*b31 - a33*b21)*(b11*r1b - xAB + b12*r2b + b13*r3b))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) - ((a13*b21 - a23*b11)*(b31*r1b - zAB + b32*r2b + b33*r3b))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2), ((a23*b31 - a33*b21)*(xAB - b11*r1b - b12*r2b + b13*r3b))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) - ((a13*b31 - a33*b11)*(yAB - b21*r1b - b22*r2b + b23*r3b))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) + ((a13*b21 - a23*b11)*(zAB - b31*r1b - b32*r2b + b33*r3b))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2), ((a23*b31 - a33*b21)*(xAB - b11*r1b + b12*r2b - b13*r3b))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) - ((a13*b31 - a33*b11)*(yAB - b21*r1b + b22*r2b - b23*r3b))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) + ((a13*b21 - a23*b11)*(zAB - b31*r1b + b32*r2b - b33*r3b))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2), ((a23*b31 - a33*b21)*(xAB - b11*r1b + b12*r2b + b13*r3b))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) - ((a13*b31 - a33*b11)*(yAB - b21*r1b + b22*r2b + b23*r3b))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) + ((a13*b21 - a23*b11)*(zAB - b31*r1b + b32*r2b + b33*r3b))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2), ((a23*b31 - a33*b21)*(xAB + b11*r1b - b12*r2b - b13*r3b))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) - ((a13*b31 - a33*b11)*(yAB + b21*r1b - b22*r2b - b23*r3b))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) + ((a13*b21 - a23*b11)*(zAB + b31*r1b - b32*r2b - b33*r3b))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2), ((a23*b31 - a33*b21)*(xAB + b11*r1b - b12*r2b + b13*r3b))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) - ((a13*b31 - a33*b11)*(yAB + b21*r1b - b22*r2b + b23*r3b))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) + ((a13*b21 - a23*b11)*(zAB + b31*r1b - b32*r2b + b33*r3b))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2), ((a23*b31 - a33*b21)*(xAB + b11*r1b + b12*r2b - b13*r3b))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) - ((a13*b31 - a33*b11)*(yAB + b21*r1b + b22*r2b - b23*r3b))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) + ((a13*b21 - a23*b11)*(zAB + b31*r1b + b32*r2b - b33*r3b))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2), ((a23*b31 - a33*b21)*(xAB + b11*r1b + b12*r2b + b13*r3b))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) - ((a13*b31 - a33*b11)*(yAB + b21*r1b + b22*r2b + b23*r3b))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2) + ((a13*b21 - a23*b11)*(zAB + b31*r1b + b32*r2b + b33*r3b))/((a13*b21 - a23*b11)^2 + (a13*b31 - a33*b11)^2 + (a23*b31 - a33*b21)^2)^(1/2)]
	if minimum(cA) >= maximum(cB) || maximum(cA) <= minimum(cB)
		overlapfun = 0.0
		return overlapfun
	end
	
	cA = [ ((a13*b32 - a33*b12)*(a21*r1a + a22*r2a + a23*r3a))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) - ((a23*b32 - a33*b22)*(a11*r1a + a12*r2a + a13*r3a))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) - ((a13*b22 - a23*b12)*(a31*r1a + a32*r2a + a33*r3a))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2), ((a13*b32 - a33*b12)*(a21*r1a + a22*r2a - a23*r3a))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) - ((a23*b32 - a33*b22)*(a11*r1a + a12*r2a - a13*r3a))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) - ((a13*b22 - a23*b12)*(a31*r1a + a32*r2a - a33*r3a))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2), ((a13*b32 - a33*b12)*(a21*r1a - a22*r2a + a23*r3a))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) - ((a23*b32 - a33*b22)*(a11*r1a - a12*r2a + a13*r3a))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) - ((a13*b22 - a23*b12)*(a31*r1a - a32*r2a + a33*r3a))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2), ((a23*b32 - a33*b22)*(a12*r2a - a11*r1a + a13*r3a))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) - ((a13*b32 - a33*b12)*(a22*r2a - a21*r1a + a23*r3a))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) + ((a13*b22 - a23*b12)*(a32*r2a - a31*r1a + a33*r3a))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2), ((a13*b32 - a33*b12)*(a22*r2a - a21*r1a + a23*r3a))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) - ((a23*b32 - a33*b22)*(a12*r2a - a11*r1a + a13*r3a))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) - ((a13*b22 - a23*b12)*(a32*r2a - a31*r1a + a33*r3a))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2), ((a23*b32 - a33*b22)*(a11*r1a - a12*r2a + a13*r3a))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) - ((a13*b32 - a33*b12)*(a21*r1a - a22*r2a + a23*r3a))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) + ((a13*b22 - a23*b12)*(a31*r1a - a32*r2a + a33*r3a))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2), ((a23*b32 - a33*b22)*(a11*r1a + a12*r2a - a13*r3a))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) - ((a13*b32 - a33*b12)*(a21*r1a + a22*r2a - a23*r3a))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) + ((a13*b22 - a23*b12)*(a31*r1a + a32*r2a - a33*r3a))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2), ((a23*b32 - a33*b22)*(a11*r1a + a12*r2a + a13*r3a))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) - ((a13*b32 - a33*b12)*(a21*r1a + a22*r2a + a23*r3a))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) + ((a13*b22 - a23*b12)*(a31*r1a + a32*r2a + a33*r3a))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2)]
	cB = [ ((a13*b32 - a33*b12)*(b21*r1b - yAB + b22*r2b + b23*r3b))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) - ((a23*b32 - a33*b22)*(b11*r1b - xAB + b12*r2b + b13*r3b))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) - ((a13*b22 - a23*b12)*(b31*r1b - zAB + b32*r2b + b33*r3b))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2), ((a23*b32 - a33*b22)*(xAB - b11*r1b - b12*r2b + b13*r3b))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) - ((a13*b32 - a33*b12)*(yAB - b21*r1b - b22*r2b + b23*r3b))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) + ((a13*b22 - a23*b12)*(zAB - b31*r1b - b32*r2b + b33*r3b))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2), ((a23*b32 - a33*b22)*(xAB - b11*r1b + b12*r2b - b13*r3b))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) - ((a13*b32 - a33*b12)*(yAB - b21*r1b + b22*r2b - b23*r3b))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) + ((a13*b22 - a23*b12)*(zAB - b31*r1b + b32*r2b - b33*r3b))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2), ((a23*b32 - a33*b22)*(xAB - b11*r1b + b12*r2b + b13*r3b))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) - ((a13*b32 - a33*b12)*(yAB - b21*r1b + b22*r2b + b23*r3b))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) + ((a13*b22 - a23*b12)*(zAB - b31*r1b + b32*r2b + b33*r3b))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2), ((a23*b32 - a33*b22)*(xAB + b11*r1b - b12*r2b - b13*r3b))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) - ((a13*b32 - a33*b12)*(yAB + b21*r1b - b22*r2b - b23*r3b))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) + ((a13*b22 - a23*b12)*(zAB + b31*r1b - b32*r2b - b33*r3b))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2), ((a23*b32 - a33*b22)*(xAB + b11*r1b - b12*r2b + b13*r3b))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) - ((a13*b32 - a33*b12)*(yAB + b21*r1b - b22*r2b + b23*r3b))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) + ((a13*b22 - a23*b12)*(zAB + b31*r1b - b32*r2b + b33*r3b))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2), ((a23*b32 - a33*b22)*(xAB + b11*r1b + b12*r2b - b13*r3b))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) - ((a13*b32 - a33*b12)*(yAB + b21*r1b + b22*r2b - b23*r3b))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) + ((a13*b22 - a23*b12)*(zAB + b31*r1b + b32*r2b - b33*r3b))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2), ((a23*b32 - a33*b22)*(xAB + b11*r1b + b12*r2b + b13*r3b))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) - ((a13*b32 - a33*b12)*(yAB + b21*r1b + b22*r2b + b23*r3b))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2) + ((a13*b22 - a23*b12)*(zAB + b31*r1b + b32*r2b + b33*r3b))/((a13*b22 - a23*b12)^2 + (a13*b32 - a33*b12)^2 + (a23*b32 - a33*b22)^2)^(1/2)]
	if minimum(cA) >= maximum(cB) || maximum(cA) <= minimum(cB)
		overlapfun = 0.0
		return overlapfun
	end
	
	cA = [ ((a13*b33 - a33*b13)*(a21*r1a + a22*r2a + a23*r3a))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) - ((a23*b33 - a33*b23)*(a11*r1a + a12*r2a + a13*r3a))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) - ((a13*b23 - a23*b13)*(a31*r1a + a32*r2a + a33*r3a))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2), ((a13*b33 - a33*b13)*(a21*r1a + a22*r2a - a23*r3a))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) - ((a23*b33 - a33*b23)*(a11*r1a + a12*r2a - a13*r3a))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) - ((a13*b23 - a23*b13)*(a31*r1a + a32*r2a - a33*r3a))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2), ((a13*b33 - a33*b13)*(a21*r1a - a22*r2a + a23*r3a))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) - ((a23*b33 - a33*b23)*(a11*r1a - a12*r2a + a13*r3a))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) - ((a13*b23 - a23*b13)*(a31*r1a - a32*r2a + a33*r3a))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2), ((a23*b33 - a33*b23)*(a12*r2a - a11*r1a + a13*r3a))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) - ((a13*b33 - a33*b13)*(a22*r2a - a21*r1a + a23*r3a))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) + ((a13*b23 - a23*b13)*(a32*r2a - a31*r1a + a33*r3a))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2), ((a13*b33 - a33*b13)*(a22*r2a - a21*r1a + a23*r3a))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) - ((a23*b33 - a33*b23)*(a12*r2a - a11*r1a + a13*r3a))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) - ((a13*b23 - a23*b13)*(a32*r2a - a31*r1a + a33*r3a))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2), ((a23*b33 - a33*b23)*(a11*r1a - a12*r2a + a13*r3a))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) - ((a13*b33 - a33*b13)*(a21*r1a - a22*r2a + a23*r3a))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) + ((a13*b23 - a23*b13)*(a31*r1a - a32*r2a + a33*r3a))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2), ((a23*b33 - a33*b23)*(a11*r1a + a12*r2a - a13*r3a))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) - ((a13*b33 - a33*b13)*(a21*r1a + a22*r2a - a23*r3a))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) + ((a13*b23 - a23*b13)*(a31*r1a + a32*r2a - a33*r3a))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2), ((a23*b33 - a33*b23)*(a11*r1a + a12*r2a + a13*r3a))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) - ((a13*b33 - a33*b13)*(a21*r1a + a22*r2a + a23*r3a))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) + ((a13*b23 - a23*b13)*(a31*r1a + a32*r2a + a33*r3a))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2)]
	cB = [ ((a13*b33 - a33*b13)*(b21*r1b - yAB + b22*r2b + b23*r3b))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) - ((a23*b33 - a33*b23)*(b11*r1b - xAB + b12*r2b + b13*r3b))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) - ((a13*b23 - a23*b13)*(b31*r1b - zAB + b32*r2b + b33*r3b))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2), ((a23*b33 - a33*b23)*(xAB - b11*r1b - b12*r2b + b13*r3b))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) - ((a13*b33 - a33*b13)*(yAB - b21*r1b - b22*r2b + b23*r3b))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) + ((a13*b23 - a23*b13)*(zAB - b31*r1b - b32*r2b + b33*r3b))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2), ((a23*b33 - a33*b23)*(xAB - b11*r1b + b12*r2b - b13*r3b))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) - ((a13*b33 - a33*b13)*(yAB - b21*r1b + b22*r2b - b23*r3b))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) + ((a13*b23 - a23*b13)*(zAB - b31*r1b + b32*r2b - b33*r3b))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2), ((a23*b33 - a33*b23)*(xAB - b11*r1b + b12*r2b + b13*r3b))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) - ((a13*b33 - a33*b13)*(yAB - b21*r1b + b22*r2b + b23*r3b))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) + ((a13*b23 - a23*b13)*(zAB - b31*r1b + b32*r2b + b33*r3b))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2), ((a23*b33 - a33*b23)*(xAB + b11*r1b - b12*r2b - b13*r3b))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) - ((a13*b33 - a33*b13)*(yAB + b21*r1b - b22*r2b - b23*r3b))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) + ((a13*b23 - a23*b13)*(zAB + b31*r1b - b32*r2b - b33*r3b))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2), ((a23*b33 - a33*b23)*(xAB + b11*r1b - b12*r2b + b13*r3b))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) - ((a13*b33 - a33*b13)*(yAB + b21*r1b - b22*r2b + b23*r3b))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) + ((a13*b23 - a23*b13)*(zAB + b31*r1b - b32*r2b + b33*r3b))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2), ((a23*b33 - a33*b23)*(xAB + b11*r1b + b12*r2b - b13*r3b))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) - ((a13*b33 - a33*b13)*(yAB + b21*r1b + b22*r2b - b23*r3b))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) + ((a13*b23 - a23*b13)*(zAB + b31*r1b + b32*r2b - b33*r3b))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2), ((a23*b33 - a33*b23)*(xAB + b11*r1b + b12*r2b + b13*r3b))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) - ((a13*b33 - a33*b13)*(yAB + b21*r1b + b22*r2b + b23*r3b))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2) + ((a13*b23 - a23*b13)*(zAB + b31*r1b + b32*r2b + b33*r3b))/((a13*b23 - a23*b13)^2 + (a13*b33 - a33*b13)^2 + (a23*b33 - a33*b23)^2)^(1/2)]
	if minimum(cA) >= maximum(cB) || maximum(cA) <= minimum(cB)
		overlapfun = 0.0
		return overlapfun
	end
	
	return overlapfun
end
